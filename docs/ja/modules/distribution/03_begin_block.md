# BeginBlock

各[BeginBlock]では、前のブロックで受け取ったすべての料金がに転送されます
`ModuleAccount`アカウントを配布します。 プリンシパルまたはベリファイアとして
報酬を引き出すと、 `ModuleAccount`から削除されます。 開始時間
ブロック、請求される料金のさまざまな請求は次のように更新されます。

- 前の高さのブロック提案者とその委任者は、1％から5％の手数料報酬を受け取ります。
- 予備のコミュニティ税を徴収します。
- 残りの部分は、議決権を通じてすべてのバインドされたバリデーターに比例配分されます

バリデーターが待機し、追加の事前コミットをブロックに含めるようにインセンティブを与えるために、ブロック提案者の報酬は、テンダーミントの事前コミットメッセージに基づいて計算されます。

## 流通計画

パラメータの説明については、[params](07_params.md)を参照してください。

[料金]を前のブロックで請求された合計料金とします。
公平性に対するインフレ報酬。 すべての料金は特定のモジュールで請求されます
ブロック期間中のアカウント。 [BeginBlock]の間に、それらはに送られます
`` "Distribute" `` ModuleAccount`。 他のトークンは送信されません。 それどころか、
各アカウントが受け取る資格のある報酬は保存され、引き出しをトリガーすることができます
メッセージ `FundCommunityPool`、` WithdrawValidatorCommission`、および
`WithdrawDelegatorReward`。

### コミュニティプールへの報酬

コミュニティプールは `community_tax * cost`に加えて、その後に残っているほこりを受け取ります
バリデーターが受け取る報酬は、常に最も近い値に丸められます
整数値。

### 報酬バリデーター

提案者は、[料金*基本提案者報酬]の基本的な報酬とボーナスを受け取ります
`fees * Bonusproposerreward * P`、ここで` P =(バリデーターと
事前コミット/総バインディングバリデーターパワーを含む) `。 より多くの事前コミット
提案者には、大きい方の[P]が含まれます。 `P`は` 1.00`より大きくなることはありません(
バインドされたバリデーターのみが有効な事前コミットを提供できます)、常により大きい
`2/3`。

残りの料金は、以下を含むすべてのバインドされたバリデーターに分配されます
コンセンサスパワーに比例した提案者。

```
powFrac = validator power/total bonded validator power
proposerMul = baseproposerreward + bonusproposerreward * P
voteMul = 1 - communitytax - proposerMul
```

一般に、提案者は `fees *(voteMul * powFrac + ProposerMul)`を受け取ります。
他のすべてのバリデーターは `fees * voteMul * powFrac`を受け取ります。

### クライアントへの報酬

各バリデーターの報酬は、その委任者に割り当てられます。 バリデーターも
通常の承認と見なされる自己承認があります
分散コンピューティング。

バリデーターは手数料率を設定します。 手数料率は柔軟ですが、それぞれ
バリデーターは、最大レートと最大日次増分を設定します。 これらの最大値を超えることはできず、バリデーターがすべての報酬を受け取らないように、バリデーターの手数料率の突然の上昇から委任者を保護します。

オペレーターが受け取る資格のある未実現の報酬は、
`ValidatorAccumulatedCommission`、およびクライアントが受け取った報酬
[ValidatorCurrentRewards]に保存されます。 [F1経費配分
スキーム](01_concepts.md)は、各プリンシパルの報酬を計算するために使用されます。
注文を撤回または更新して、[BeginBlock]で処理されないようにします。

### サンプル配布

この配布例の場合、基礎となるコンセンサスエンジンは次のとおりです。
結合された電力全体に対するそれらの電力の比率。

すべてのバリデーターは、提案に事前コミットを含めることで同じように動作します
ピース。 次に、 `(事前コミットを含む)/(バインディングバリデーターの合計パワー)`を保持します
一定であるため、バリデーターの償却ブロック報酬は[(バリデーターパワー/総拘束力)*(1-コミュニティ税率)]です。
トータルリワード。 したがって、1人の委任者に対する報酬は次のとおりです。

```
(delegator proportion of the validator power/validator power) * (validator power/total bonded power)
  * (1 - community tax rate) * (1 - validator commision rate)
= (delegator proportion of the validator power/total bonded power) * (1 -
community tax rate) * (1 - validator commision rate)
```
